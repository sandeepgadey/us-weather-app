// Weather App with City Selection\n// Using Open-Meteo API (free, no API key required)\n\n// Major US Cities with coordinates\nconst CITIES = {\n    seattle: { name: \"Seattle, WA\", lat: 47.6062, lon: -122.3321, timezone: \"America/Los_Angeles\" },\n    nyc: { name: \"New York City, NY\", lat: 40.7128, lon: -74.0060, timezone: \"America/New_York\" },\n    la: { name: \"Los Angeles, CA\", lat: 34.0522, lon: -118.2437, timezone: \"America/Los_Angeles\" },\n    chicago: { name: \"Chicago, IL\", lat: 41.8781, lon: -87.6298, timezone: \"America/Chicago\" },\n    houston: { name: \"Houston, TX\", lat: 29.7604, lon: -95.3698, timezone: \"America/Chicago\" },\n    phoenix: { name: \"Phoenix, AZ\", lat: 33.4484, lon: -112.0740, timezone: \"America/Phoenix\" },\n    philly: { name: \"Philadelphia, PA\", lat: 39.9526, lon: -75.1652, timezone: \"America/New_York\" },\n    san_antonio: { name: \"San Antonio, TX\", lat: 29.4241, lon: -98.4936, timezone: \"America/Chicago\" },\n    san_diego: { name: \"San Diego, CA\", lat: 32.7157, lon: -117.1611, timezone: \"America/Los_Angeles\" },\n    dallas: { name: \"Dallas, TX\", lat: 32.7767, lon: -96.7970, timezone: \"America/Chicago\" },\n    austin: { name: \"Austin, TX\", lat: 30.2672, lon: -97.7431, timezone: \"America/Chicago\" },\n    jacksonville: { name: \"Jacksonville, FL\", lat: 30.3322, lon: -81.6557, timezone: \"America/New_York\" },\n    fort_worth: { name: \"Fort Worth, TX\", lat: 32.7555, lon: -97.3308, timezone: \"America/Chicago\" },\n    columbus: { name: \"Columbus, OH\", lat: 39.9612, lon: -82.9988, timezone: \"America/New_York\" },\n    charlotte: { name: \"Charlotte, NC\", lat: 35.2271, lon: -80.8431, timezone: \"America/New_York\" },\n    san_francisco: { name: \"San Francisco, CA\", lat: 37.7749, lon: -122.4194, timezone: \"America/Los_Angeles\" },\n    indianapolis: { name: \"Indianapolis, IN\", lat: 39.7684, lon: -86.1581, timezone: \"America/New_York\" },\n    denver: { name: \"Denver, CO\", lat: 39.7392, lon: -104.9903, timezone: \"America/Denver\" },\n    washington: { name: \"Washington, DC\", lat: 38.9072, lon: -77.0369, timezone: \"America/New_York\" },\n    boston: { name: \"Boston, MA\", lat: 42.3601, lon: -71.0589, timezone: \"America/New_York\" }\n};\n\nlet currentCity = 'seattle';\n\nfunction getApiUrl(cityKey) {\n    const city = CITIES[cityKey];\n    return `https://api.open-meteo.com/v1/forecast?latitude=${city.lat}&longitude=${city.lon}&current_weather=true&hourly=temperature_2m,relative_humidity_2m,surface_pressure,visibility,wind_speed_10m&temperature_unit=fahrenheit&wind_speed_unit=mph&timezone=${encodeURIComponent(city.timezone)}`;\n}\n\n// DOM elements\nconst temperatureElement = document.getElementById('temperature');\nconst descriptionElement = document.getElementById('description');\nconst feelsLikeElement = document.getElementById('feels-like');\nconst humidityElement = document.getElementById('humidity');\nconst windSpeedElement = document.getElementById('wind-speed');\nconst pressureElement = document.getElementById('pressure');\nconst visibilityElement = document.getElementById('visibility');\nconst weatherIconElement = document.getElementById('weather-icon');\nconst lastUpdatedElement = document.getElementById('last-updated');\nconst errorMessageElement = document.getElementById('error-message');\nconst refreshButton = document.getElementById('refresh-btn');\nconst dateElement = document.getElementById('date');\nconst cityElement = document.getElementById('city');\nconst citySelectElement = document.getElementById('city-select');\n\n// Initialize the app\ndocument.addEventListener('DOMContentLoaded', function() {\n    updateDateTime();\n    initializeCitySelector();\n    loadWeatherData();\n});\n\n// Initialize city selector\nfunction initializeCitySelector() {\n    citySelectElement.addEventListener('change', function() {\n        currentCity = this.value;\n        updateCityDisplay();\n        loadWeatherData();\n    });\n}\n\n// Update city display\nfunction updateCityDisplay() {\n    const city = CITIES[currentCity];\n    cityElement.textContent = city.name;\n}\n\n// Update date and time\nfunction updateDateTime() {\n    const now = new Date();\n    const options = { \n        weekday: 'long', \n        year: 'numeric', \n        month: 'long', \n        day: 'numeric',\n        hour: '2-digit',\n        minute: '2-digit'\n    };\n    dateElement.textContent = now.toLocaleDateString('en-US', options);\n}\n\n// Load weather data from API\nasync function loadWeatherData() {\n    try {\n        // Show loading state\n        refreshButton.textContent = 'Loading...';\n        refreshButton.disabled = true;\n        errorMessageElement.style.display = 'none';\n\n        const apiUrl = getApiUrl(currentCity);\n        console.log('Fetching weather data from:', apiUrl);\n        const response = await fetch(apiUrl);\n        \n        if (!response.ok) {\n            const errorData = await response.text();\n            console.error('API Error Response:', errorData);\n            throw new Error(`HTTP error! status: ${response.status} - ${errorData}`);\n        }\n        \n        const data = await response.json();\n        console.log('Weather data received:', data);\n        displayWeatherData(data);\n        updateLastUpdated();\n        \n    } catch (error) {\n        console.error('Error fetching weather data:', error);\n        showError(error.message);\n    } finally {\n        // Reset button state\n        refreshButton.textContent = 'Refresh Weather';\n        refreshButton.disabled = false;\n    }\n}\n\n// Weather code to description mapping for Open-Meteo\nfunction getWeatherDescription(weatherCode) {\n    const descriptions = {\n        0: \"Clear sky\",\n        1: \"Mainly clear\",\n        2: \"Partly cloudy\",\n        3: \"Overcast\",\n        45: \"Fog\",\n        48: \"Depositing rime fog\",\n        51: \"Light drizzle\",\n        53: \"Moderate drizzle\", \n        55: \"Dense drizzle\",\n        56: \"Light freezing drizzle\",\n        57: \"Dense freezing drizzle\",\n        61: \"Slight rain\",\n        63: \"Moderate rain\",\n        65: \"Heavy rain\",\n        66: \"Light freezing rain\",\n        67: \"Heavy freezing rain\",\n        71: \"Slight snow fall\",\n        73: \"Moderate snow fall\",\n        75: \"Heavy snow fall\",\n        77: \"Snow grains\",\n        80: \"Slight rain showers\",\n        81: \"Moderate rain showers\",\n        82: \"Violent rain showers\",\n        85: \"Slight snow showers\",\n        86: \"Heavy snow showers\",\n        95: \"Thunderstorm\",\n        96: \"Thunderstorm with slight hail\",\n        99: \"Thunderstorm with heavy hail\"\n    };\n    return descriptions[weatherCode] || \"Unknown\";\n}\n\n// Get weather emoji for Open-Meteo weather codes\nfunction getWeatherEmoji(weatherCode) {\n    const emojis = {\n        0: \"‚òÄÔ∏è\", // Clear sky\n        1: \"üå§Ô∏è\", // Mainly clear\n        2: \"‚õÖ\", // Partly cloudy\n        3: \"‚òÅÔ∏è\", // Overcast\n        45: \"üå´Ô∏è\", // Fog\n        48: \"üå´Ô∏è\", // Depositing rime fog\n        51: \"üå¶Ô∏è\", // Light drizzle\n        53: \"üå¶Ô∏è\", // Moderate drizzle\n        55: \"üåßÔ∏è\", // Dense drizzle\n        56: \"üå®Ô∏è\", // Light freezing drizzle\n        57: \"üå®Ô∏è\", // Dense freezing drizzle\n        61: \"üå¶Ô∏è\", // Slight rain\n        63: \"üåßÔ∏è\", // Moderate rain\n        65: \"‚õàÔ∏è\", // Heavy rain\n        66: \"üå®Ô∏è\", // Light freezing rain\n        67: \"üå®Ô∏è\", // Heavy freezing rain\n        71: \"‚ùÑÔ∏è\", // Slight snow fall\n        73: \"üå®Ô∏è\", // Moderate snow fall\n        75: \"‚ùÑÔ∏è\", // Heavy snow fall\n        77: \"‚ùÑÔ∏è\", // Snow grains\n        80: \"üå¶Ô∏è\", // Slight rain showers\n        81: \"üåßÔ∏è\", // Moderate rain showers\n        82: \"‚õàÔ∏è\", // Violent rain showers\n        85: \"üå®Ô∏è\", // Slight snow showers\n        86: \"‚ùÑÔ∏è\", // Heavy snow showers\n        95: \"‚õàÔ∏è\", // Thunderstorm\n        96: \"‚õàÔ∏è\", // Thunderstorm with slight hail\n        99: \"‚õàÔ∏è\"  // Thunderstorm with heavy hail\n    };\n    return emojis[weatherCode] || \"üå°Ô∏è\";\n}\n\n// Display weather data on the page\nfunction displayWeatherData(data) {\n    try {\n        const current = data.current_weather;\n        const hourly = data.hourly;\n        \n        // Current temperature\n        temperatureElement.textContent = `${Math.round(current.temperature)}¬∞F`;\n        \n        // Calculate feels like (simple approximation based on temperature and humidity)\n        const currentHour = new Date().getHours();\n        const currentHumidity = hourly.relative_humidity_2m[currentHour] || hourly.relative_humidity_2m[0] || 50;\n        const feelsLike = calculateFeelsLike(current.temperature, currentHumidity, current.windspeed);\n        feelsLikeElement.textContent = `${Math.round(feelsLike)}¬∞F`;\n        \n        // Weather description\n        const description = getWeatherDescription(current.weathercode);\n        descriptionElement.textContent = description;\n        \n        // Weather emoji instead of icon\n        const emoji = getWeatherEmoji(current.weathercode);\n        weatherIconElement.src = `data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><text y=\"70\" font-size=\"60\">${emoji}</text></svg>`;\n        weatherIconElement.alt = description;\n        \n        // Additional information\n        humidityElement.textContent = `${Math.round(currentHumidity)}%`;\n        windSpeedElement.textContent = `${Math.round(current.windspeed)} mph`;\n        \n        // Get current hour pressure\n        const currentPressure = hourly.surface_pressure && hourly.surface_pressure[currentHour] ? \n            hourly.surface_pressure[currentHour] : 1013;\n        pressureElement.textContent = `${Math.round(currentPressure)} hPa`;\n        \n        // Get current hour visibility\n        const currentVisibility = hourly.visibility && hourly.visibility[currentHour] ? \n            hourly.visibility[currentHour] : 10000;\n        const visibilityMiles = (currentVisibility * 0.000621371).toFixed(1);\n        visibilityElement.textContent = `${visibilityMiles} miles`;\n        \n    } catch (error) {\n        console.error('Error displaying weather data:', error);\n        showError('Error processing weather data. Please try refreshing.');\n    }\n}\n\n// Simple feels-like temperature calculation\nfunction calculateFeelsLike(temp, humidity, windSpeed) {\n    // Basic heat index calculation for feels-like temperature\n    if (temp >= 80) {\n        // Heat index formula for hot weather\n        const hi = -42.379 + 2.04901523 * temp + 10.14333127 * humidity \n                  - 0.22475541 * temp * humidity - 6.83783e-3 * temp * temp \n                  - 5.481717e-2 * humidity * humidity + 1.22874e-3 * temp * temp * humidity \n                  + 8.5282e-4 * temp * humidity * humidity - 1.99e-6 * temp * temp * humidity * humidity;\n        return hi;\n    } else if (temp <= 50 && windSpeed > 3) {\n        // Wind chill formula for cold weather\n        const wc = 35.74 + 0.6215 * temp - 35.75 * Math.pow(windSpeed, 0.16) + 0.4275 * temp * Math.pow(windSpeed, 0.16);\n        return wc;\n    }\n    return temp; // No adjustment for moderate temperatures\n}\n\n// Show error message\nfunction showError(customMessage = null) {\n    const defaultMessage = 'Unable to load weather data. Please check your internet connection and try again.';\n    const message = customMessage || defaultMessage;\n    \n    errorMessageElement.innerHTML = `\n        <p><strong>Error Loading Weather Data</strong></p>\n        <p>${message}</p>\n        <p style=\"font-size: 0.9em; margin-top: 10px;\">\n            <strong>Troubleshooting:</strong><br>\n            ‚Ä¢ Check your internet connectivity<br>\n            ‚Ä¢ Check browser console (F12) for detailed error information<br>\n            ‚Ä¢ Try refreshing the page\n        </p>\n    `;\n    errorMessageElement.style.display = 'block';\n}\n\n// Update last updated time\nfunction updateLastUpdated() {\n    const now = new Date();\n    const timeString = now.toLocaleTimeString('en-US', {\n        hour: '2-digit',\n        minute: '2-digit',\n        second: '2-digit'\n    });\n    lastUpdatedElement.textContent = timeString;\n}\n\n// Refresh weather data (called by button click)\nfunction refreshWeather() {\n    updateDateTime();\n    loadWeatherData();\n}\n\n// Auto-refresh every 10 minutes\nsetInterval(() => {\n    loadWeatherData();\n}, 600000); // 10 minutes = 600,000 milliseconds\n\n// Update date/time every minute\nsetInterval(updateDateTime, 60000);